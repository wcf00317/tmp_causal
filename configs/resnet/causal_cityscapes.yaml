# configs/cityscapes_reproduce_best_edge5.yaml
# 基于 run.log (2025-12-12_00-52) 复现
# 修改点: lambda_edge_consistency 1.0 -> 5.0

data:
  type: "cityscapes"
  dataset_path: "/data/chengfengwu/alrl/mtl_dataset/cityscape_preprocess"
  batch_size: 64
  num_workers: 4
  img_size: [128, 256]
  pin_memory: true

model:
  type: "causal"
  encoder_name: "resnet50"
  pretrained: true
  latent_dim_s: 1024
  latent_dim_p: 2048
  num_seg_classes: 7
  num_scene_classes: 1
  decomposition:
    enabled: true
    light_head:
      sh_degree: 2

training:
  seed: 2025
  epochs: 100
  optimizer: "AdamW"
  learning_rate: 0.0001
  weight_decay: 0.01

  # === 关键的时间表设置 (保持原 log 一致) ===
  stage0_epochs: 5     # 分解预热
  stage1_epochs: 40    # 结构预热 (前40个epoch)
  ind_warmup_epochs: 30

  lr_scheduler:
    type: "cosine"
    warmup_epochs: 5
    min_lr_factor: 0.01

losses:
  # === 任务权重 ===
  lambda_seg: 10.0
  lambda_depth: 30.0   # 保持原 log 中的高压配置
  lambda_normal: 0.0
  lambda_scene: 0.0

  # === 解耦 ===
  lambda_independence: 10.0

  # === 重构 ===
  alpha_recon_geom: 2.0
  beta_recon_app: 5.0
  lambda_l1_recon: 1.0

  # === [MODIFIED] 边缘一致性 ===
  # 原 log 为 1.0，这里提升至 5.0 以攻克 Depth Abs Err
  lambda_edge_consistency: 1.0

  # === 分解正则 ===
  lambda_img: 5.0
  lambda_sh_gray: 0.1